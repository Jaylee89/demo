<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<script type="text/javascript" src="http://www.jq-school.com/js/jquery-1.7.2.min.js"></script>
<title>漫画分享自己做的瀑布流Jquery特效例子</title>
<style>
body,ul,ol,h2,h3,h4,h5,p,dl,dt,dd,form{padding:0;margin:0;}img{border:none;}li{list-style:none;}a{text-decoration:none;outline:none;color:#666666;}a:hover{text-decoration:none}img{border:0}ul{list-style:none;margin:0;}label{color:#6CBD45;font-size:14px;font-weight:bold;padding-bottom:0.5em;margin:0;}.h3{font-size:13px;font-weight:bold;}#show{background:url(images/photo.jpg)}#meun{color:#fff;padding-left:10px;}#meun img{float:left;}#submeun{margin-left:70px;float:left;}#submeun span{text-align:center;margin-right:10px;float:left;display:inline;}#submeun span a{color:#fff;height:50px;line-height:50px;font-size:14px;font-weight:bold;text-align:center;padding-left:15px;padding-right:15px;display:block;}#submeun span.cur{text-align:center;background:#82ce18;margin-right:10px;float:left;display:inline;}#top{background-color:#000;margin:0em 0 10px 0em;border-style:solid;border-width:1px;border-color:#E5E5E5;height:50px;line-height:50px;}label.subtitle{font-size:13px;float:right;color:#6CBD45;margin:0 10px;text-align:right;}h1.title{height:50px;font-size:12px;background:url(logo.png) no-repeat;}h1.title a:link,h1.title a:visited,h1.title a:hover{color:#000;text-decoration:none;}</
*{padding-bottom:0px;line-height:1.7em;margin:0px;padding-left:0px;padding-right:0px;padding-top:0px}
body{width:auto;height:auto;color:#666;padding:20px;text-align:center;}
a{text-decoration:none}
img{border:0}
#listing .post{border:#ccc 1px solid;padding:2px;text-align:justify;;margin:0px 30px 30px 0px;background:#e2e2e2;float:left;}
.post{width:280px;text-align:center;}
.post a{text-align:center;display:block;}
</style>
</head>
<body>
<div id="top">
  <label class="subtitle"> JQuery让你的前端设计更精彩！</label>
  <div id="meun"><a href="http://www.jq-school.com/" title="Jquery-School"><img src="http://www.jq-school.com/logo.png" /></a>
    <div id="submeun">
      <span><a href="http://www.jq-school.com/">首 页</a></span>    
	   <span class="cur"><a href="javascript:void(0)">漫画分享自己做的瀑布流Jquery特效例子</a></span>
    </div>
  </div>
  </div>
<br />
<div id="listing">
  <div class="post"><a href="#"><img src="images/16.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片16</a></div>
  <div class="post"><a href="#"><img src="images/17.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片17</a></div>
  <div class="post"><a href="#"><img src="images/18.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片18</a></div>
  <div class="post"><a href="#"><img src="images/19.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片19</a></div>
  <div class="post"><a href="#"><img src="images/20.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片20</a></div>
    <div class="post"><a href="#"><img src="images/5.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片5</a></div>
  <div class="post"><a href="#"><img src="images/7.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片7</a></div>
    <div class="post"><a href="#"><img src="images/3.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片3</a></div>
  <div class="post"><a href="#"><img src="images/4.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片4</a></div>
</div>

<script src="js/jquery.masonry.min.js" type="text/javascript"></script>
<script type="text/javascript">	
	var flag = true;
	$(function(){			
		var $container = $('#listing');    
		$container.masonry({
			singleMode: true,
			animate: true,
			itemSelector: '.post'
		});		
		//滚动条滚动到离底部距离50的时候触发
		$(window).scroll(function(){
			// 当滚动到最底部以上100像素时， 加载新内容
			if ($(document).height() - $(this).scrollTop() - $(this).height()<50){	
				if (flag){
					var $boxes = $(getList());	 
					$container.append($boxes).masonry('appended',$boxes);
				}
			}
		});	
	});	
	//测试获取列表
	function getList() {	
		var boxes = [],count = parseInt(Math.random()*10); 
		for (var i=0; i < count; i++ ) {
			boxes.push('<div class="post"><a href="#"><img src="images/'+(i+1)+'.jpg" width="280" alt="" /></a><a href="#" target="_blank">图片'+(i+1)+'</a></div>');
		}
		//把数组转成字符串
		return boxes.join("");
	};
</script>
</body>
</html>
